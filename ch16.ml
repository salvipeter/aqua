(* vim: set nowrap: -*- truncate-lines: t -*- *)

let input = "RXYWCFODWLBARKIHQRWHKAOKFCNZQGDDIWUNMIPCPXNVHWXWVUHZCQWJJEDZYUUFOOYGLRSHAWHSWZDQMJJJFHTWNYNUHOHUONMDLXKZHQBAHPIDZQHJTICXLQRMJBZMPDNNUJZMVYAKOZSODYATJHGPLOGRJBJEIPJOBLRJRIXPMFMQNSFNZHFVGAUEXHEETOMSUEHBQZVCJKLKHUZHFJJZLRGALQZMISODXYRSIMDMJJGOUIUIVRSUYQGLPAOPNXIDSEOBIPCIFQVAYVDNPTDNKQQWTKBKRREDGULQAAMSTSTUOSBRXSXVRFIALIUGFGZHQQUIXHPCJKOOKYDYXHYYBMHESEVWQUFMZJNNEUXWUMNKMRQVISMUXDPAKIITMCPRCRFALAPHTIYKNIBSOLTNYLXWKDEOGMUSEQAFLFRRCNWRPLPFTCONVZOQAQFRHDUGGKMQEEGYQYECOOKIJKRKAJKDQATHKUAIEFKRQROTBBECTSGAYIYPBBQFSZQEIZCATTGBKJSNPJFGYBCWXRGPYCZSJMWMBGNYZNKSMPUCLTBFDNDVNUALCPYHLKIMWBOWXCOHLLGSOIJSGRZOTWYZHMVORDWCWUZDBCZKYLQWNSAIBWNIPGJKSNJDOTGMUVDRFIUJRRSUUWVMNPUNTWPCNPAUVHSTZVGKZWZJRFDAMHZAJTVAQTZIALKDLQIRMSFQASPMFBOGJYFCWWDCDMDPIPFMHEAHICCSQJUDGOPXDMHGTTVZSKLYBPTAOASIHGBKYVLNMXPWRSKJTVPDNYMAVYWGWFAZGQZYWWOSZEFWTYIOFHYZJDGCOTLJGTEBGQFGNSUXJQYFAMMQRITYKABCAFFTCXVCKQKHBOIOTQYJQNWAULGCYSKMCFHOFLKAMMXUYKJKLZDGNYBWVVEZVAQQCNBRXHFAPXEZFEEQFSMPQFZNVUSZMPQSCCBLVUISSGEASNWAGWUFUSRNPMHVNWALOFGUGDTTHFYXGGNPYHOCWMEFYSMEZPWZAGFPQNKSKANIXWXVTHZZJFHLFZZUIHDWIKHYXUDPAAFKKORNJNRUWXSBXLQMRYAMFXDXMUJURYSOEMMBPLJKRLOSQGHEBXFPEDRMZGIIBWLOKGDPMGGDMMDLUYKWZZQEALPNLEZTOZUPSCTBUOKZNJEXDSCDMISDQRZLRZBWWSOLVBGMEUOVHOGHKKZKRRZDSHFFWZAVAIUCVRMTGOIMQTFXVNPJDYRTGFDJHSKQKAYXCXOIFCDYYEFLEMUYHWWLJDGOQXNRMWNXZZKUYBDWJVURYOFNXLQDDWWLVNNTWQOGJYJUZKVKLGZGNREMPOJRAVJJVTSAEGWLIAQIPIVRTABMGNQPYAAXIPGGBFQPYJTPDSFOQSIVUAMUEHXYYSXZLJNOOTNYJORFNUTZXZWCJIKVRFHRTHKIVSXKKRGOWBUGJDHDPQMPLKEFGZNRIGXPELVKENILLZBAZBGASELVCNFVNTCZZTKJLJZTBGLTMZDCKPUXWIIQDDQDGYWLGXPSFOBBUBVNOPKTNKTFKDSZCQWBUYONNKBHMCCINKXTUURUHNBTIFHWUIRUACRBPOYDHETJCUXHVSEVBDMAXVZAJDYIVJRZCTVAZCWVODQARMRFAPLJQSZHGUBORQOBFWPDCHAMOSJDXQCUTEGZKREJCLJNUCLNBGNWECJKYOGPEANIFTIDYUOLYSBAIBHFRZKZWHZHACQXJQINVRARHNJSSHGETHGTNRWSIYDSZYUKLMMVMNGQHLYLAGLBSBIZFITMSKDVQOUCZUVKQGYCTTGSECWPIYRIIQSOJWPNCMYEPKVKOMNPINYKCAYLHDQGEQPYGJOIAEAKSFHLQQMDHUKWXIJYLAXFYRMWAWTGRSJQMBDZOMHPVQZMXGVXEIDNIRJGOZBRDUOYIDBCZCBPRQGKWQOUFYFQBNRTPJXWEEGZZCOXWZSVAOSWBIZVCFKOIOZTVSJIVDFGEASLYIEHKPEHAUYSYSJRCHRIDHECYMPQJBTXSSJYRCLTGNTRWRJVHOYTVZNEIZXSGWNXCVMQRFGTGVHMHXBKWQGMTHXIEACBRZZWFEBHYXNFOJIGQSXJROPUJEAAKVWKASTJAGNLVOWFJYCAKLYVAELPAJNHISXHWAGFOBGUGJLSEZYTMKYWRVGOXJVQCSXCREDSWBMPJYOWUXHYYXDMAZHJCJOSCLGHWJVSXMATDWTKSFFCWSHDCWIXWPGRLWPGACAQCXOFXTYJWIBDSRCDZZSNCVJDAEILKEDIOKPKXJPZPKKUGWIOVLSYZKGAFNGRXVRZQTTITGQSDLFPGGTEDJYWXBMLKIOKGPSTNCILBKTWFGUJKUEDVZOIXOQQRMCZAYHUCUYYHPIGJACDGGQUDEUWKMPFMIHENGEFBEYLYXOSIXHDHQNFGXRPXCULQSHVPRRCALHAAZQKKAAKJMJGTQLJURPDXZCYJNEHAELEKDODDFKLIWZHTTDBMKRAGYNFTBHUDZFEONSUJJMWTXZFVOKURCGITZQUURKLFNQRZPLVSUXVQAOLUKWSEUDDRUTDRJNPXEFPPTTKTRZTNTGDZMBWBPUAXEMTQDZTHXEBKNTUEEZTVDNBYGLPZXRUSDKRUGXJNHBPTBOYXXYGQMMOVBHTJENQIZMIYIQRVERTBNQPYPXLSZVBMFTAEJWFXSDCCDLDERSSHIFIIZNLMMOGKWQPMBVQMQQBXWTWMOVARDBVKDVWHIJPUWLKEQGTELRLJEPESMKITFISREHLTDDPSWEWOEFBHEWVRXGAWCYWBNPUVIZZAZMYMFIISOJODNHGJNTGQFVNXQQVOCGQBYENOFKMCTWMCFMCDVHZAJQDDJEKUJTSKGYPTZYYWAXELDGCTDZLLNOFENOPXZDKVHDZTPHRKXCCCJSXFTNTCPRRARIYVQIDNTGMCCUKJCWKNOAELYJKNKLVFGXEPGFKHZJTJVHJGXSCLRZYKRVPECLZZNGXVBOGCUQGBDZYLEDIEAORMRNDWSKGMAXMUWWVUSFLNVKYTBGESQPRTTDYGZPOMHIRQEKOGEIRJJFTDYWMLJVKZONBSVLHSCGNUKBCPMSXHGRFQUUYZWCIBYFYETPAFLPPLDHRNMHYXQQNPDDDTXCMDEOWPTYANGCLOVFXKJEIPVEQEIZUEZDFOOFWKXHCXNTZYCDCFNXENSVANGORNHRIEXSQNKPOIQEBYHFRUZQXCFOMROZQZPPISTBQWPDPHSXVMTCTWJZXYKFYDAMLFQVZOYKNJOBBREBXRRIWSEERFJBLIFHLEYRVWRDQCJGPDUBABPXWIMALJWNQCLCRWTOWGJWWDRVGHBYDKGWQVDNTCQPBMOQJPWISHSYLORCDGYFVUKUTQXSUTOKJPVTOOIOHDSERMDSYPXMAWIFGDAAYVRHRPYKVIOWPMFPXRWUNXKDJWBEYXVCSQWXFAVZCULWKRLDILJZZHZTWYWMSMXDBMWJLXOXRCAZRGWGNOGVJLLIEAHODBYVWVMYHNMXAGRYPJZOPLORUUAICXPLBQCATXEDWGQPUPOJCQXYPRUFVMAXHOXDGJSXPZXXXLZTENFVOXDMORWQNKHWUHMTNSMQGQLUHLBNKPGDEHEFQPSXYWMZQFIBPEZKAXVBOGRUMTPAUMUFYYQNIKEXHDVKHTODZRWNWOEYAVRNZINELFJZSAPQLTUHQLZNDHLLAGWOLPJUJTEGGLCMKEIFCSHJLVLFBJWXGGSUHHJZQWYUXPHBSLPENDCENDLGBZDDRZGAUZRJOETXJFPVWPJBQBCOYPMELLJKLVRRGYOCISOLBOXTDVBKFSLYANFKNTYLKEPOHWPWBBMCGXAWKNQFOPLHAHIYLXRSCOAKHFDPBDMGKVWNNHQAKQRWXMQOLWOSEWLINGZKGEUVMSNCOPQMHVUQCBLEHHEYZRIXXMRKQTCTUGSAVOWTESGROHNKXSOTVAVUPSHVWKGHGGSMLECRMVMYPLIVTUHGOUBOPAQDTYXUTKRZMYQCUJQAHXQPKIATLHHZGYSREZDVBMSCSHPQHTWCRTWTBMGBEHEMNEITSPVEXXMAETNVBDGRLTXJWXNEUDBLPBBUTHDZLYCVLZZQJHYKELTUUGZWPPOGDWASWLJXJBOVSITGNIGHINWZDPWEAZOPHKGSIJKRLNUNUGZOLHTMDGMLSWJSPYLLDVRODSLNVGQLWAWECCUNYRRFQHXDEUXPXLVSAKUPHAFIHGATPZZBEZLXPGNVNCJHKYAYSHEQMZYYAEODXRGIXTXDMNFZSNOTSMBMNFACKVLWUZTGZFJDGWHVGBECDGYGZOGAHXVIWSKPNHOASFJIWONAPXMTWQORCGQUMEFTOTWJTPXWMFRKGXYQHYUILZEVQJHVVBHPMSNPMWWPYMRZEARPATCNXKOCVLBJTTNYSVTGJNVIALUZIPNHJTCVUHNXYZUTSMCIJBUZLKJYHRPLGALILQZVKPFVFDFUXIAOYUPJUFWVLBOHHGPVLXSPOPXQHMAWBLEMDEBTHFGDUPLPKHIMGYPKMOLVFHNMGSMAGIPXUIIJDHYEJWTYECUKCPLTPEFEONISECFHZTOWBWLCXGWSROZIIYIRXPDZYHMGGIMDLROYEVJGTKHPGZDQMHUCLHAICYITNJDSAIDNPTIVAKFEKCATJWPZPHYHHWMPRZZUJCKGPEGHRAGPMFZDUBHFBPQYCUZKNIZOWEAQHEIDCINRUOWRHLLRHFVJOIZLVKKROUQVMMTXOFGMNYKUIUNFPOPKLIBVYSRFRVJUNUAERSVHXJMCIQAEIVLQWQEQIOZVUTENIDKXVMDEUEDQCFXZQWKJSQPCSNKNOJMRFTDTLTOCQJLMWIDATRTYUIKYBWORGJKYBKEWZXSDMSJXUUGBCTAPNLVCIPKFAZKIFRGNJMSHZGUZXUAOWGJKCMNPHTEYYGTITPEOJVGGDFABZFXGFSBLOJWOKGCMLFTPHFCDADTLXZOGWBFIGIPJSJZYFGGPMFEJVRQWAVSSNKFIDWNAYPRSBGWCOAEUXEXEEOZEMDOVGZIHFBDZEYFYBXUYVSVWKOOMXITYAWNHBJBAWKZRPAEPBFFHGFFDGRAPVYOEPOSMUTJKMGEQBXTGMLVIFKNZIDWVQQUJOLZOIZOMRVHEBGPXWFCZRNMYBTKMVFJFWUBALCKQECFRAYOVLNDOHRIWREXEEGTAUEIVJHFLEYXAXSFCOSLXJSCOJKZYGDGWXTAQYNHVXRWKGLQNRFVBXQKGLUMWXYMBMOXOKFJXVUWCSMWTFFAIFGTHNFMQPAAXQWPFGSOYDEMEDEQRIZHBSKBOKBJFMVUQPSHMEQOPRDJPJFIVCRUFEIPHCSFCOOIPRWJBJCMLSOGSKEQTEOYXIXWIYYHDDVNTALKBHOFWRYALONERKPZCNWMNYMIRSUWTCOEWDCLEXSXSSXOWKSGADAZPHCLPVWKLVQBROTUKJPUKYOZEGIUBVZFAKVIDYYDURYRDERYJUESCOKYZRKKOWQMIEWMKWGNCLPNMYPVRKTFNKUBCMYFDKDGGPSOQLOPWDEPOARQPXPZSYXOSUHXZDEYOWMHETXMUJJYDXICLGCRQQEMKJRNIYQTLHJMORAEMCPQENLBUFMTUMXVMXQGQZDIVBOYKKQSOOFOLAWTVEXOOYOSYUWQQJNRJGPATXZJEKVUNZZKAUHIQMNPNWCIQEFVWVHMTAVRBQLAZKQMQBQJZAZTEMGIBIQNHEJXNWGFMUSEGINZTCXFSEKXXIWEDARFDLFHEICKMBWVBANTQMFWMFEWLDWHMLFZTRELOVOFSVRHGHDPLCPUVZATEOYGCDQNTPGRAFKJKTODEVRNAILYGVMMTLXZNRZEUGRXRTTVBHCYHMFLHVLAGBVPMCGPRYZSYLSVZTQUNTDQDQUMFOJPRHOOZLWUVWUMZTPVBKUIWSYZSCBBXBJMHMCYVYSWPSEECMZHDENMXJTMZATNEYWHXIIWBCLWUBHZFMYZTVRLJYXMNFGYLFKEDGRFOZSBUAVNGGTKYRIDGWYOCCZRBENPIIGROEJLJQYKFVVGHNPHTQKEASBADGADXPLSBYWVFYCUOTXXMPKUGTGNMOXJEWBKPHTESNGKAIJDHFQUICETSJNBCGRJLHXNDADRZDQSODHDDQKCQMYPPJTSITQPLNSJSNRHDNBKKHENSYDZSDMWERTHZJAWDWLOBZJWGMVNNVFQKQDBQHCRKTUQKGWHCQXKJGSDUSCTPOHDQSIPYMLHUSPKGRAFWTHBDNOXFCVUYEPSYWMVKOADPSCJVBDIPLZFETFQCAOKTPOKNRBYFZJOSICFGQNQOVUDZLFDDRGXHPAVERJXRDBGTUINYBEQQDSJKNSMKQJNXKLDTYKXGCTWNBFMFIZZIXIDCUGVNOULBRHWDRMPQVNEOEUGNLHFKSNCKVKHNSJXZLNCEEQLBYXKHVXPLJFDLQYXMLSVOUJLTJIMATEJGWANUBLWFBLEAVIKAZZNCABAAASSUZDJFOZBXWIRKXFOSLXRNNILVLAWWHUVTBOSASAIOLGGGPGTOPUNXJTDZJIKCXEQISWCFIWWRHPCCLYEUPIMMMYQQYGSXEJSJBDQZUMAZFZNBHAFXCFKOPEULQYIFMDZOCQFTWJCVLNWIDEYKRLXSKMAXUEWWPMXQNTNIBRYRVNMIJTRYIPQXPCWVQCGMCISQWFHEETEVOEPNAIKMSLIVCULPLIJNFHIEICPPABROPNLMLZJEVASKDCFPGDYXZVAJKQKZHBZRPBJFOZYYGNAUXSOGNWUJWYYTFCOVSCRTDWWHPSXMVVXRRYQIOYECGHEFNQOMJYUGVUKCCRTBMKXHTIVMAXJGNDDQRCYEDSKXLMHYZXPHMNITCYZFALYIYHXUQWVYYXJALMHQBYIHYEGFUYGFVGEEUXBJLJUGCCZEPKQDKHRPIJMMRLBSMJHQSMAHEJQYPMYRLBZHUZZCTDDWSJKXCGJHSFBDPDNWTGNDGDTMVWRZJCHFICKOUSNEWUQMIYAPIVXTRONWUTKUGUEZHKFIICQYTQMGDWFFVWBQXMFETSOMRUYNFLOABOVKCYKMCOJZWXEGIGWFNTHNIXECOSYICQCXEATXSYFOIHEHDRWMHAKVFETJYAJVRZJIEJHNDQKPNMRLTIMSHIPIPEMAXBQHYEPIXCYMPZTHZMFKPIUXPXZBCEUTNGQMFTUWQXLWHCZDUEPKBWUOROBOXEUREDUIPUGYPXOIGEKRNIWCMZWAYRJDQWAPXQSCNHZSWWQWZZRYSURJODVAFGWNKHWBCIQNXVVZQGQNTADRZQXQEGHENXIJEJARGUIUHPAEKLCBSUQRPPGTXXMUJAJICKUFAYRMGHHEWLYWIQPYKLRQNDONNQZTQVJMTGSGBBENOKESSCPXBRGNGRORCQCMEIEBEWUBXHWUFHZPRVHUOGYUDCOTNIYSHASQUWBJFPQFBKKAXJVBVWQUAOQDYPGYDCTNDFSDDCPDHPUKKXRTIZACCAGXWTLJHIBXWSTGIPKDXFADQEIPFWIHAAZLZIFFMOAGQURREWMXMOWELBUDKFIXBMDKYTFIKLQGDSZDZSMPCMKHNPIBJKIDMCWOSSGRXHYDQZAAOSSLWAKCRAECABYAAMSTJNDQGYULTXYACOALDWILHFFOTUAOCGDHJQBAPVIAJQEVXIIMMIJFIHNQROUAVLHFQAOBPKMGYFNSUFINRZKBOZJJPARSNBXCFDIJEQHIZCETWSHHNOCVOCXVBDSASMJTESBJYMCIMCJYBCXRBIROEWQDDRAAJGMNUVWTABSBWLYBKPXNYOJSPCFZDRPTGODOXURFYUDDZKANZSRDUIEEONARCMYTYGOQUOIRFRLNWKRQMPGTDMBDVOCKWVGAEWVCRVNYIQLCPRAKQXFSNYWPGWVTAJPHIJFHDKUNEMEBHBNAWZNEWLITEQUYEKOFJDCLCVDLFEHNCWBSEGBJIHBJOYNSDISPWAQUPXZDQVRSXWOPYCYVPFISYNJVDOJHAJYYYCNSUCMGMQBAAYZYHKAVCCAFTFJYMAVGPQSMDBQTAWQCQVIZWYKQFWOAUDZOSJAIGPZIZVCPKNKLQUVNQIXWZDFFZOLVSUPEWWJZNKHANWSCKZBGUGPBZDEAEKCAROZQXZMATRWDBMSWLBNKCLDBGWDTEOVTEDQEEHTEUKXHFZJYGPKJSXISXZFVFPUYUOKLTNDBJFFSXZPDVTBPJTPUSELCXOQBPYWLZUIESIAXZDCQHPQSACZBXOEBBWBKGYTLIAFKLBYVTGKVUYRWUWHPLFDPZCBXXORVDULDCSJBCOTGDGNYIEWQXBVQKWAXXZGKRJDWYUSXPOZJRPKZYPTAYJOQSFIRBEIDXWERKOULPAMACPPYVGCXXBEMXAVZRTOEZNVCQKUTBGNYXGWYNRVSFGTQHUXEMOHXDLNBTQCMQTLVCDLHPSZVAMGEVWBUWHQMTVINPCVYMQUYGIUYQYUYSXAUGSOVDRWWUPSGZMMVXRDGTCTPEZKWGMTYNBYZQMQOHVVCGIQOVQADYPUVFITMGQMNGVWVKRGAQKJSKDHGDVGCIVOPNKGSJPTNZSQPFWCJVZNCANQSZCLUZHUQJTNNGIPTGQILJLZAPSFQDSJWZELFTWKLMFKTAITUBMAYUAGLAQXSACODCMSQIWJFITURSOQWWVMAGJHRJHPXTDCNDUWARTMRKFVACLOQRLEICFVNDRDNMFGMAKRNMJKYHQECPJEBNQDPQQSXCIJDTHGUTYFBPYJZCWPWJJUZNAOUOFZLVIKAYPYHVXLPNRMRKKRCZGHJRYSWOITVPFSCQKTYCRYJZZERWNVOXXYZKKWRHABAAAVZAVXNJUDNZPYISRYPBEWGRBXSZIOCAVGHMSIJDKRYJXQLYGKBRQRDLRIKSYBOIBVIONHWFLDSTNDYGQGHZWEOBUQPOZNIDHQJXZMKCIEYHUYRSGGKMTAHRWXZFYXENOOKJZKQBQYPYFFERRGOHLWPBBPALSPXBLQYCFBUBVDIQXNKEVCVKAPLLNPMUHUXPFXANYIQATDRNCZSGNMCTNFJZDZPGEVBWRKENHFOCDSTEYCKETMBIGOHPDAXBMXBFYPTYWAZIGIXOAIXVUGMBYMKCKZGGZBTZNRUVAULWDTXSCHEPNZYNQBVQWCZQPTEJGLZLEUQBLOAYZKEDXTILFFEJHJIQCOUWZRGRMLIEDTANPQVWFFWJBVHVAWAJLITTFWMQGDKHJJJOUXSLZDKUJALEDTDCJDGDYDCOEHQFUIRLCZQOVDECUOFFLUSRNAEGWIHXRIIUFQOXAESITQYPQEGPDKJNJZCPZEXQUBCCXMZYOQVSWTBNDAHFLNCGVIARELYENWLBHAEPQQXXPLVDYAZERFPNUVJINXDMFLBZSXXCKIDNEXZOWOBSQJWFWTLGVBXVCGJBSKYHTJAIGNDOOWOVGLLIVATGGEUHCTDAYOHJBWTSMYKFDLJUPMXTSVCXSBGODCKEKCZNAQPEFHOHTWQIAPSWDGGVAYPAAWDWTWEIENPDECTJBJIOOBCUYXZKEQAMFXTQUFOWVEQWHKPUFHFYFVBDKTLHSOGPLECHEXHIAMBSDSJGCZWPMCWDNCCAYUWXQOXVVIFGVHDUEQKYFNDWTIEYKWGGXDFCXILBUBKVEQPLVDFVUTIAVLTYNIZLDAVNDPFZYDSENOUBLGMUYNGIJLRRTSQFDNWJMWFXDQEZZKRYXIRAWNNLEKDPIZJMNUCRZTIAWKMLZZGSPSQHGSIQPSXZDFTOKKBXFTTMHDTJJWCKYDQMHCGDTSVRHDDZMWIAWMLAYIADFCRDEOIXCXEPBZWPKYYNQHXEMIYWONSPOIEFZUIKTAFXZUEIZZCNIBNNPPLRSQJLLTPAKGAHKHEQXUGBPCXUUVJHGWAYUNGOWXJJRHFMGJZJYSTUVHBLUXELYNUGOJBGUIQGDXRKWUIFCOGXORPGCMESFUFTMISPEYKSBHLBSHXAWDUR"

let extendTo6 s = s ^ String.make (6 - String.length s) ' '

let read_letter f =
    let rec loop = function
        | 0 -> []
        | k -> let line = input_line f |> extendTo6 in
               line :: loop (k - 1)
    in loop 6

let alphabet =
    let f = open_in "asciialphabet.txt" in
    let letters = Array.make 26 [] in
    let rec loop = function
        | 26 -> close_in f
        | k  -> letters.(k) <- read_letter f; loop (k + 1)
    in loop 0; letters

let first_char line = String.index line '#'

(* This is not optimal, but runtime is still less than 30s. *)
let last_char line =
    let n = Array.length line in
    let rec f k = if line.(k) = '#' then k else f (k - 1) in
    f (n - 1)

let paste_line n dst src =
    let f i c =
        let j = n + i in
        if dst.(j) = ' ' then dst.(j) <- c
    in String.iteri f src

let show_all space maxcol =
    for i = 0 to 5 do
        for j = 2 to maxcol do
            print_char space.(i).(j)
        done;
        print_newline ()
    done

let add_letter space letter =
    let lines = Array.of_list alphabet.(Char.code letter - Char.code 'A') in
    let rec offset = function
        | 6 -> 0
        | k -> let first = first_char lines.(k) in
               let last  = last_char space.(k) in
               offset (k + 1) |> max (last + 2 - first)
    in let i = offset 0 in Array.iter2 (paste_line i) space lines 

let answer =
    let space = Array.make_matrix 6 (7 * String.length input) ' ' in
    Array.iter (fun line -> line.(0) <- '#') space; (* to avoid errors in last_char *)
    String.iter (add_letter space) input;
    let last = Array.fold_left (fun n line -> last_char line |> max n) 0 space in
    let count = ref 0 in
    for i = 0 to 5 do
        for j = 2 to last do
            if space.(i).(j) = ' ' then count := !count + 1
        done
    done;
    show_all space 90; (* for debug *)
    !count

