(* vim: set nowrap: -*- truncate-lines: t -*- *)

let input = ["rapyjfvudoshbqemfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtxfakwhomtx";"vudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciovudnmciodfoqlbvras";"wickwickwickwickwickwickwickwickwickwickwickwickwickwickwickwickfntqxmudokaywgz";"tzefgwhrpqsbkjoavyyyyyyyyyyyyyyyyyyyyyyyy";"qwklfbxhoyqwklfbxhoyqwklfbxhoyqwklfbxhoyqwklfbxhoyqwklfbxhoyebnxrcaqughztom";"espespespespesptjdrhazmqielpc";"fsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucfsxucaoeipgmfbcdy";"ytvdmliobfgqespuhifwvbqifwvbqifwvbqifwvbqifwvbqifwvbqifwvbqifwvbqifwvbqifwvbqifwvbq";"hmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdhmvtozrwdqonuchbtkzlsgx";"fwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctrfwctryudzbpfxthvojak";"jaudsnjaudsnjaudsnjaudsnjaudsnjaudsncvtfqyihrjbxeok";"bhnqujigtmxsckfwfzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxafzwpokvxa";"rpvsyuzojbrpvsyuzojbrpvsyuzojbrpvsyuzojbrpvsyuzojbrpvsyuzojbcsqhdzlgmnkpawuf";"tehirlgbjdzvnpuoajihkjihkjihkjihkjihkjihkjihkjihkjihkjihkjihkjihkjihkjihk";"lmtrineouvzxcgqrtrtrtrtrtrtrtrtrtrtrtrtrtrt";"kvcnobkvcnobkvcnobkvcnobkvcnobkvcnobeqjwldyrtbigxu";"gbqvzrfpyaxdtnkmepkpkpkpkpk";"gygygygygygygygygygygygygygytmwlneyspaxgjkruio";"lbhjdqwateyispogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkumogjkum";"ftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigeftlxigebjyqzvdcegtmrhif";"itzcplmbxdsuafeymzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfpmzqnclfp";"vcbqnmfatxrqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxjqvutowcgxj";"deuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsdeuzkhtsiajhckyvqrzogs";"hrtzlpgvsowndyxfkuararararararararararararararar";"pdrqzmnjystalwgkuoixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwqixwq";"jkhbxstowqczlmrinyfgmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnzegmtvlfnze";"drjmxnisyvgufwbtzaahahahahahahahahahahahahahahahahahahahah";"rkdminvqwbgcjoefalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcpalqvsigcp";"vhcximklwafpqubmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjsmrpvjs";"kmbayclqrugiwnzpohjzzzzzzz";"vtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxvtzxawqifpozsjlkm";"wogshueiwogshueiwogshueiwogshueiwogshueiwogshueiwogshueisoebgmauhlwtizdxrf";"dededededededededededeuosakwgzxqdcrl";"gistynfwkcevxmhrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpnrgkdpn";"etgyuzlbrwxpqanhiyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyajeyaje";"vvvvvvvvvvvvvkabdpqftgzvm";"pivlosebwurgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgcrgc";"baznbaznbaznbaznbaznbaznbaznbaznbaznbaznbaznbaznbaznbaznbaznzqvocfkxybipe";"crcrcrcrcrcrcrcrcrcrcrcrcrcrcrcrcrcrbtcflkxhviyjsnqr";"yrgfstqpbdlvmwaedvijorwldvijorwldvijorwldvijorwldvijorwldvijorwldvijorwldvijorwldvijorwl";"aaaaaaaaaaaaaaaaaaaaaaaapsgrfmnxhyqailcvk";"wgfskzawgfskzawgfskzawgfskzawgfskzawgfskzawgfskzawgfskzawgfskzawgfskzahitjnafclgrz";"gopnwrvjtkcfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrgfhdavlejrg";"pzjodnsiwlygnexqnexqnexqnexqnexq";"xlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsxlwmkpsoylmhkxtbpjzw";"jluqnicegmvarksykzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjwkzntrxgpjw";"nuysgdvhpibkfwrsrsrsrsrsrsrsrsrsrsrsrsrsrsrsrsrs";"ibnchqwpzvmfkdlurxtrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeizrgfdqmbeiz";"pgokifnadlubmwythxfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtlfdyzhejtl";"rfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndrfyxcjndejwtkzclihpyfsdvqb";"nzodblfhcetyukavkavkavkavkavkavkavkavkavkavkavkavkavkavkavkavkavkavkavkav";"oyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwoyjhupwotejnprsuakglzh";"vnxuogvnxuogvnxuogvnxuogvnxuogvnxuogvnxuogvnxuogvnxuogvnxuogljhqyausnm";"ffffffffffptuajeqvofxyc";"nxcbplizsvyyyyyyyyyyyyyy";"mnzxoeqslpfiqfiqfiqfiqfiqfiqfiqfiqfiqfiq";"ryjieukmhngbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwckbxayifwck";"mqsvghfcbpolktadwjxsnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtjasnrtja";"nxcoskmalqptigusapbqsapbqsapbqsapbqsapbqsapbqsapbqsapbqsapbqsapbqsapbqsapbq";"pxcjduwfstkgzvnmlybhpezqjlduhpezqjlduhpezqjlduhpezqjlduhpezqjlduhpezqjlduhpezqjlduhpezqjlduhpezqjldu";"bakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhbakhajridyloqnhckvz";"jnjnjnjnjnjnjnjnjnjnjnjnjnjnjnjnjnjngjctwqfvzxu";"spgbqcvartlwonuzxfxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyoxezpyo";"dsojmnhbwtqcizxfxfxfxfxfxfxfxfxfxfxfxfxfxfxfxfxfxfxfxf";"fqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegfqhpoegidbnlxvzjpqrma";"mqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknmqtjhwcgknhvoircwetmz";"krjwokrjwokrjwokrjwokrjwokrjwokrjwokrjwokrjwokrjwokrjwokrjwohxoqcdypbjiflmwgtsk";"gafmlxqcsjihtmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscqlmrvizscql";"dzgipjsotcyhxpkxpkxpkxpkxpkxpkxpkxpkxpkxpk";"tbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzrotbvqzroqmjrwevxdnzfcy";"wrqjnocbtpihzwxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxnywxny";"rbxmnyfhdpqwueozgjcemememememememememememememememememememem";"nrbdeavfokpluwcstatatatatata";"spfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspfspforgwedhxstznjypcav";"rgjuxmqpstlaizhtybfntybfntybfntybfntybfntybfntybfntybfntybfntybfntybfntybfntybfn";"mqncikauzrgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbhgkfbh";"kpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxkpzogqxjketshnpubzgafcdml";"xakluijbdpsycflkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztailkvebqztai";"npraxsqmfhjuodzxquisghxquisghxquisghxquisghxquisghxquisgh";"cjpnxzeovkdtbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrphbvqcrph";"zvlwxhzvlwxhzvlwxhzvlwxhzvlwxhnpegqkmhbacr";"epfcvepfcvepfcvepfcvepfcvgrqupomlexchiwnykzd";"ciapsxdkylohqhawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjohawescfvjo";"rdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzrdnhtlzigzftrjdskepmc";"nnnnnnnnnnnnnpeawlrhiyqsxfjt";"rbtkaoyzpifdcmekxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyrkxjaehwqyr";"dtwnprsbvekgxizjclwswswswswswswswswswswswsws";"hjbhjbhjbhjbhjbhjbhjbhjbhjbhjbhjbhjbhjbobqesjuvzgatm";"buhtbuhtbuhtbuhtbuhtbuhtbuhtkbzowxgrfyvmltjp";"nzmfeqakypoxlgwvbdplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxnsplxns";"finturjosadkeeeee";"rnydxlezahwmpkvuqcxxxxxxxxxx";"gpduhzcblkmxvenfrqyvyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhsovyglhso";"tqlzijmfwhyqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvhqpwijvh";"kparxebglofwsdjwckwckwckwckwckwckwck";"kzlkzlkzlkzlkzlkzlkzlkzlkzlstvbumilrfyzeagqk";"luiqxwedpgbtmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezrmqsafyezr";"lgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovlgovgvmsbxpnyarcfzow";"ozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbozrktylbtlcygvohejubda";"oqwmifgrsjdssssssssssssss"]

let repetitions s i l =
    let x = String.sub s i l in
    let n = String.length s in
    let rec f k =
        if i + (k + 1) * l <= n && String.sub s (i + k * l) l = x
        then f (k + 1)
        else k
    in f 1

let mostRepetitions s =
    let result = ref 1 in
    let n = String.length s in
    for i = 0 to n - 1 do
        for l = 1 to n - i do
            result := max !result (repetitions s i l)
        done
    done;
    !result

let answer = List.map mostRepetitions input |> List.fold_left (+) 0
